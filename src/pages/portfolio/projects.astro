---
export const prerender = true;

import { getCollection } from "astro:content";
import { Icon } from "astro-icon/components";
import GridLayout from "@layouts/grid.astro";
import BackwardButton from "@components/backwardButton.astro";

const title = "Projects";
const description = "Featured drone photography and videography projects";

// Get all posts for projects
const allPosts = await getCollection("posts");
---

<GridLayout title={title} description={description}>
    <div class="flex w-full rounded-(--radius-large) overflow-hidden relative min-h-32">
        <div class="card-base z-10 px-9 py-6 relative w-full">
            <BackwardButton currentPath={Astro.url.pathname} />
            <div class="space-y-8 mt-2">
                <!-- Header -->
                <div class="text-center space-y-4">
                    <div class="flex justify-center mb-4">
                        <div class="w-16 h-16 rounded-lg bg-(--primary)/10 flex items-center justify-center">
                            <Icon name="material-symbols:work" class="text-(--primary) text-2xl" />
                        </div>
                    </div>
                    <h1 class="text-4xl font-bold text-neutral-900 dark:text-neutral-100">
                        Featured Projects
                    </h1>
                    <p class="text-lg text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto">
                        Selected drone photography and videography work showcasing diverse aerial perspectives
                    </p>
                </div>

                <!-- Projects Grid -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {allPosts.map((post) => (
                        <div class="card-base p-4 border border-(--line-color)">
                            {post.data.cover && (
                                <img 
                                    src={post.data.cover} 
                                    alt={post.data.title}
                                    class="w-full h-48 object-cover rounded-lg mb-4"
                                />
                            )}
                            <h3 class="font-semibold text-neutral-900 dark:text-neutral-100 mb-2">
                                {post.data.title}
                            </h3>
                            <p class="text-sm text-neutral-600 dark:text-neutral-400 mb-3">
                                {new Date(post.data.published).toLocaleDateString()}
                            </p>
                            <div class="flex flex-wrap gap-2 mb-3">
                                {post.data.tags.map((tag) => (
                                    <span class="px-2 py-1 text-xs rounded-full bg-(--primary)/10 text-(--primary)">
                                        {tag}
                                    </span>
                                ))}
                            </div>
                            <a href={`/posts/${post.id}/`} class="btn-regular rounded-lg px-4 py-2 w-full">
                                View Project
                            </a>
                        </div>
                    ))}
                </div>

                {allPosts.length === 0 && (
                    <div class="text-center py-12">
                        <p class="text-neutral-600 dark:text-neutral-400">
                            No projects yet. Check back soon!
                        </p>
                    </div>
                )}
            </div>
        </div>
    </div>
</GridLayout>
